{% extends 'accounts/main.html' %}

{% block content %}

{% load static %}

<style>
    .area {
        position: absolute;
        cursor: pointer;
        /* opcional: para ver las zonas mientras pruebas */
        /* background-color: rgba(255, 0, 0, 0.2); */
    }
    .sensor-data {
            display: grid;
            grid-template-columns: 1fr 1fr;
            row-gap: 10px;
            column-gap: 10px;
        }

        .sensor-title {
            font-weight: 600;
            color: #0d6efd;
        }

        .sensor-value span {
            font-size: 1.5rem;
            font-weight: bold;
            color: #0d6efd;
        }

        .unit {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .card-body h5 {
            font-weight: 600;
            color: #343a40;
        }

        input[type=range] {
            width: 100%;
        }
        @media (max-width: 768px) {
            .sensor-data {
                grid-template-columns: 1fr; /* Una sola columna en m칩viles */
            }
        }


        .colorCardPWM {
            background: #251d1d;
        }
        
        #mensajeinformacionsistema{
            background: #89d668;
            font-size: 10px;
            
        }





        .card {
            border-radius: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .slider-value {
            font-weight: bold;
            text-align: center;
        }

        input[type=range] {
            -webkit-appearance: none;
            /* Chrome, Safari, Opera */
            appearance: none;
            /* Firefox, Edge */
            width: 100%;
            height: 8px;
            background: #ffffff;
            border-radius: 5px;
            outline: none;
        }

        /* Track */
        input[type=range]::-webkit-slider-runnable-track {
            height: 8px;
            background: #ffffff;
            /* Cambia este color */
            border-radius: 5px;
        }

        /* Thumb (el "bot칩n" del slider) */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #ff1c07;
            /* Amarillo */
            margin-top: -6px;
            /* Alinear con el track */
            cursor: pointer;
        }

        /* Firefox */
        input[type=range]::-moz-range-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #ffc107;
            cursor: pointer;
        }

        input[type=range]::-moz-range-track {
            background: #0d6efd;
            height: 8px;
            border-radius: 5px;
        }

        #pwmSlider::-webkit-slider-runnable-track {
            background: #ed1111;
        }


        #pwmSlider::-webkit-slider-thumb {
            background: #d01414;
            /* Gris oscuro */
        }

</style>


<br>


<!-- Bootstrap CSS CDN -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@600&display=swap" rel="stylesheet">


<div class="row card card-body m-2 text-center  ">
    <h2>Modelo Did치ctico de Sistema de Preparaci칩n de L칤quido Dializante</h2>
</div>
<div class="row m-2">
    <div class="col-12 col-sm-4 col-md-3 col-lg-2 mb-3">
        <div class="card card-body ">
            <nav class="nav flex-column">
                <h5 class="mb-3 text-center">Men칰</h5>
                <ul class="nav flex-column  nav-pills nav-fill">
                    <li class="nav-item text-center mb-3">
                        <a class="nav-link active bg-dark" href="{% url 'iniciar_quiz' %}">Iniciar Quiz</a>
                    </li>
                    <li class="nav-item text-center mb-3 ">
                        <a class="nav-link active bg-dark" href="{% url 'ingresar_contrase침a' %}">Editar Quiz</a>
                    </li>
                    <li class="nav-item text-center mb-3 ">
                        <a class="nav-link active bg-dark" href="{% url 'ingresar_contrase침aresultados' %}">Resultados</a>
                    </li>
                    <!-- Puedes agregar m치s enlaces aqu칤 -->
                </ul>
            </nav>
        </div>
    </div>
    <div class="col-12 col-sm-8 col-md-9 col-lg-7 mb-3">
        <div class="card card-body">
            <div class="card card-body mb-3">
                <h2>Etapas</h2>
                <div class="form-group">
                    <select class="custom-select" name="" id="etapaseleccionada" onchange="showImage()">

                        <option selected>Selecciona una Etapa</option>
                        <option value="etapa1" class="seleccionetapa1">Etapa 1</option>
                        <option value="etapa2" class="seleccionetapa2">Etapa 2</option>
                        <option value="etapa3" class="seleccionetapa3">Etapa 3</option>
                        <option value="etapa4" class="seleccionetapa4">Etapa 4</option>
                        <option value="etapa5" class="seleccionetapa5">Etapa 5</option>
                    </select>
                </div>
            </div>
            <div class="card card-body mb-3" style="max-width: 100%;">

                <div class="position-relative w-100">
                    <img src="/static/images/Etapa0.png" alt="Imagen seleccionada" class="img-fluid" id="imagen-base">

                    <!-- 츼reas interactivas -->
                    <div class="area" data-toggle="tooltip" title="Etapa 1: Agua para dialisis"
                        style="top: 31.04%; left: 6.19%; width: 7.50%; height: 10.99%;"
                        onclick="cambiarContenido('etapa1')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 1: Sensor de Flujo"
                        style="top: 32.14%; left: 16.38%; width: 4.88%; height: 8.63%;"
                        onclick="cambiarContenido('etapa1')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 2: Mezcla de concentrados"
                        style="top: 31.04%; left: 24.82%; width: 11.13%; height: 10.60%;"
                        onclick="cambiarContenido('etapa2')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 2: Concentrado 치cido"
                        style="top: 1.51%; left: 22.34%; width: 3.85%; height: 12.64%;"
                        onclick="cambiarContenido('etapa2')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 2: Concentrado alcalino"
                        style="top: 7.01%; left: 34.00%; width: 4.20%; height: 12.91%;"
                        onclick="cambiarContenido('etapa2')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 3: Sensor de Conductividad"
                        style="top: 31.46%; left: 39.74%; width: 4.52%; height: 9.89%;"
                        onclick="cambiarContenido('etapa3')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 3: Sensor de Burbujas"
                        style="top: 31.46%; left: 47.96%; width: 4.59%; height: 9.51%;"
                        onclick="cambiarContenido('etapa3')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 3: Sensor de Temperatura"
                        style="top: 31.87%; left: 56.91%; width: 4.66%; height: 9.07%;"
                        onclick="cambiarContenido('etapa3')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 4: Filtro  Dializador"
                        style="top: 47.66%; left: 56.27%; width: 5.83%; height: 32.41%;"
                        onclick="cambiarContenido('etapa4')"></div>
                    <div class="area" data-toggle="tooltip" title="Etapa 5: Drenaje"
                        style="top: 90.38%; left: 35.22%; width: 8.29%; height: 6.04%;"
                        onclick="cambiarContenido('etapa5')"></div>
                </div>


            </div>
            <div class="card card-body mb-3" id="tarjeta-info">
                <p id="info">Haz clic sobre un componente para ver el detalle de cada etapa.</p>
            </div>
        </div>
    </div>
    <div class="col-12 col-sm-4 col-md-3 mb-3">
        <h4 class="mb-4">Panel de control</h4>
    
        <div class="card card-body mb-3">
            <h5 class="mb-3">Lecturas de Sensores</h5>
            <div class="sensor-data">
                <div class="sensor-title">Flujo</div>
                <div class="sensor-value" id="valorsensor1">
                    <span id="valorFlujo">{{ sensor_data.flujo }}</span>
                </div>
                <div class="unit">ml/min</div>
                <div></div>

                <div class="sensor-title">Conductividad</div>
                <div class="sensor-value" id="valorsensor2">
                    <span id="valorConductividad">{{ sensor_data.conductividad }}</span>
                </div>
                <div class="unit">uS/cm</div>
                <div></div>

                <div class="sensor-title">Burbuja</div>
                <div class="sensor-value" id="valorsensor3">
                    <span id="valorBurbuja">{{ sensor_data.burbuja }}</span>
                </div>
                <div></div>



            </div>
        </div>

            <div class="card card-body mb-3">
            <h5 class="mb-3 text-center ">Informaci칩n del sistema</h5>
            <div class="card card-body mb-3  " id="mensajeinformacionsistema" >
                <div class= "w-100 d-block ">
                    <div class=" text-white sensor-title text-center w-100" id="mensaje1">
                        <span id="mensaje1" class="w-100 d-block" >{{ sensor_data.mensaje1 }}</span>
                    </div>   
                </div>             
            </div>
            
        </div>
    
        <div class="card bg-light card-body mb-3">
            <div class="card-header bg-danger text-white text-center">
                Control PWM Bomba Principal
            </div>
            <div class="card-body">
                <input type="range" class="form-range container-fluid" min="0" max="100" step="1" id="pwmSlider">
                <div class="slider-value mt-2" id="valor">50%</div>
            </div>
        </div>
    
        <div class="card card-body">
            <div class="  card bg-light">
            <div class="card-header bg-info text-white text-center">
                Valor Objetivo de Conductividad
            </div>
            <div class=" card-body">
                <label for="calibracionConductividad" class="form-label">Ingrese valor objetivo (uS/cm):</label>
                <div class="d-flex">
                <input type="number" class="form-control" id="objetivoConductividad" placeholder="Ej: 1500">
                <button class="btn btn-info ml-2" onclick="enviarObjetivoConductividad()">Set</button>

                </div>

            </div>
            </div>
        </div>


        <div class="card card-body mt-3">
            <div class="card bg-light">
            <div class="card-header bg-danger text-white text-center">
                Led integrado
            </div>
            <div class="card-body text-center">
                <button class="btn btn-success ml-2" onclick="enviarComando('LON')">Encender</button>
                <button class="btn btn-danger ml-2" onclick="enviarComando('LOFF')">Apagar</button>
            </div>
        </div>

        </div>
    </div>
    
</div>


<!-- Modal -->
<div class="modal fade" id="miModal" tabindex="-1" aria-labelledby="miModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="miModalLabel">Informaci칩n</h5>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- El contenido del modal ser치 insertado aqu칤 -->
            </div>

        </div>
    </div>
</div>




<!-- Bootstrap JS CDN and dependencies -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- Optional: Chart.js for analytics graph -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/image-map-resizer/1.0.10/js/imageMapResizer.min.js"></script>


<script>
  // 游대 Manejador del slider para PWM
  document.getElementById('pwmSlider').addEventListener('input', function () {
    const valor = this.value;
    document.getElementById('valor').innerText = valor + "%";
    enviarComando(`PWM&valor=${valor}`);
  });

  // Enviar objetivo de conductividad
  function enviarObjetivoConductividad() {
    const valor = document.getElementById('objetivoConductividad').value;

    if (valor === "") {
      alert("Por favor, ingresa un valor.");
      return;
    }

    enviarComando(`CO&valor=${valor}`);
  }

  // Funci칩n para enviar comandos a Django
function enviarComando(comando) {
    fetch("https://web-production-ad431.up.railway.app/set_comando/", {
        method: "POST",
        headers: {
        "Content-Type": "application/x-www-form-urlencoded"
        },
        body: `comando=${encodeURIComponent(comando)}`
    })
    .then(response => {
        if (!response.ok) throw new Error("Respuesta no OK");
        return response.json();
    })
    .then(data => {
        console.log("Comando enviado al servidor Django:", data);
    })
    .catch(error => {
        console.error("Error al enviar comando:", error);
    });
}


  // Funci칩n auxiliar para obtener el token CSRF
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== "") {
      const cookies = document.cookie.split(";");
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === name + "=") {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }

  function obtenerDatosSensores() {
  fetch('/api/datos_sensores')
    .then(response => response.json())
    .then(data => {
      document.getElementById('valorFlujo').innerText = data.flujo;
      document.getElementById('valorConductividad').innerText = data.conductividad;
      document.getElementById('valorBurbuja').innerText = data.burbuja;
      document.getElementById('mensaje1').innerText = data.mensaje1;
    })
    .catch(error => {
      console.error('Error al obtener los datos desde Django:', error);
    });
}

obtenerDatosSensores();
setInterval(obtenerDatosSensores, 1000);

</script>


<script>
    window.onload = function () {
        const datos = {
            etapa1: {
                imagen: '/static/images/Etapa1.png',
                texto: `
            <p>
                En esta etapa, el agua tratada es adecuada para ingresar al circuito de l칤quido dializante. 
                Este proceso consiste en atemperar al agua con un calentador, a temperaturas entre los 35춿C y los 37춿C 
                para favorecer tanto la desgasificaci칩n como la posterior disoluci칩n de las sales en ella. 
                Tambi칠n pasa a trav칠s de un desgasificador, con el fin de eliminar el ox칤geno y otros gases disueltos del agua.
            </p>
            <p>
                Los mecanismos de seguridad son esenciales ya que una mala desgasificaci칩n generar칤a burbujas de aire, 
                que podr칤an hacer funcionar mal el detector de fugas de sangre y el detector de conductividad.
            </p>
            <button class="btn btn-light m-2" onclick="mostrarMensaje1()">Agua para di치lisis</button>
            <button class="btn btn-light m-2" onclick="mostrarMensaje2()">Flujo del l칤quido dializante</button>
            `,
                color: '#99ff66'
            },
            etapa2: {
                imagen: '/static/images/Etapa2.png',
                texto: `
                    <p>
                        En la preparaci칩n de l칤quido dializante para hemodi치lisis, se utilizan concentrados de 치cido y bicarbonato. 
                        Estos concentrados son esenciales para la eliminaci칩n adecuada de toxinas y desechos del torrente sangu칤neo del paciente durante la di치lisis.
                    </p>
                    <p>
                        <strong>Concentrado 츼cido:</strong>
                        <ul>
                            <li><strong>Normales:</strong> 0.1 N o 2-4 mEq/L aprox. Crucial para mantener el equilibrio del pH sangu칤neo durante la hemodi치lisis.</li>
                            <li><strong>Concentraci칩n baja:</strong> Alcalosis metab칩lica.</li>
                            <li><strong>Concentraci칩n alta:</strong> Acidosis metab칩lica.</li>
                        </ul>
                    </p>
                    <p>
                        <strong>Concentrado Bicarbonato:</strong>
                        <ul>
                            <li><strong>Normales:</strong> 32-40 mEq/L. Ayuda a neutralizar los 치cidos en la sangre y a mantener el equilibrio 치cido-base.</li>
                            <li><strong>Concentraci칩n baja:</strong> Acidosis metab칩lica.</li>
                            <li><strong>Concentraci칩n alta:</strong> Alcalosis metab칩lica.</li>
                        </ul>
                    </p>
                    <button class="btn btn-light m-2" onclick="mostrarMensajeLiquidoDialisis()">L칤quido de Di치lisis</button>
                    <button class="btn btn-light m-2" onclick="mostrarMensajeLiquidoDialisisUltra()">L칤quido de Di치lisis Ultrapuro</button>
                    <button class="btn btn-light m-2" onclick="mostrarMensajeConcentradoAcido()">Concentrado 츼cido</button>
                    <button class="btn btn-light m-2" onclick="mostrarMensajeConcentradoBicarbonato()">Concentrado Bicarbonato</button>
                    `,

                color: '#ffaa00'
            },
            etapa3: {
                imagen: '/static/images/Etapa3.png',
                texto: `
                    <p>
                        La conductividad del agua es un par치metro importante para controlar la calidad del l칤quido dializante. 
                        Se mide en microsiemens por cent칤metro (췃S/cm). Los valores normales de conductividad oscilan entre 13.6 y 14.4 췃S/cm. 
                        Si la conductividad es anormal, puede indicar una concentraci칩n inadecuada de electrolitos en el agua.
                    </p>
                    <p>
                        La temperatura del l칤quido tambi칠n es cr칤tica para el funcionamiento adecuado del tratamiento. El rango normal de temperatura oscila entre 35춿C y 37춿C. 
                        Temperaturas superiores a 37.5춿C representan un riesgo de coagulaci칩n sangu칤nea, mientras que temperaturas por debajo de 34춿C podr칤an causar hipotermia en el paciente.
                    </p>
                    <p>
                        La presi칩n del sistema es otro par치metro esencial. Los valores normales de presi칩n suelen encontrarse entre 1.5 y 2.5 bares. 
                        Una presi칩n m치s alta podr칤a ser indicativa de una obstrucci칩n en el sistema, mientras que una presi칩n baja podr칤a indicar una fuga o mal funcionamiento en el equipo.
                    </p>
                    <button class="btn btn-light m-2" onclick="mostrarMensajeConductividad()">Conductividad</button>
                    <button class="btn btn-light m-2" onclick="mostrarMensajeTemperatura()">Temperatura</button>
                    <button class="btn btn-light m-2" onclick="mostrarMensajePresion()">Presi칩n</button>
                    `,
                color: '#4dd2ff'
            },
            etapa4: {
                imagen: '/static/images/Etapa4.png',
                texto: `
                <p>
                    Consiste en interponer entre 2 compartimientos l칤quidos (sangre y l칤quido de di치lisis) una membrana semipermeable. 
                    Para ello se emplea un filtro o dializador. La membrana semipermeable permite que circulen agua y solutos de peque침o 
                    y mediano peso molecular (PM), pero no prote칤nas o c칠lulas sangu칤neas, muy grandes como para atravesar los poros de la membrana.
                </p>
                <p>
                    Los mecanismos f칤sicos que regulan estas funciones son dos: la difusi칩n o transporte por conducci칩n y la ultrafiltraci칩n o 
                    transporte por convecci칩n.
                </p>
                <button class="btn btn-light m-2" onclick="mostrarKoA()">KoA</button>
                <button class="btn btn-light m-2" onclick="mostrarGradiente()">Gradiente de Concentraci칩n</button>
                <button class="btn btn-light m-2" onclick="mostrarDialisancia()">Dialisancia I칩nica</button>
                <button class="btn btn-light m-2" onclick="mostrarUltrafiltracion()">Transporte por Convecci칩n (Ultrafiltraci칩n)</button>
                <button class="btn btn-light m-2" onclick="mostrarDifusion()">Transporte por Difusi칩n</button>
            `,
                color: '#e60000'
            },
            etapa5: {
                imagen: '/static/images/Etapa5.png',
                texto: `
                    <p style="color: #ffffff;">
                        Tras pasar por el dializador, el sistema se encarga de controlar posibles p칠rdidas hem치ticas utilizando sensores 칩pticos de infrarrojos o ultrasonidos.
                        Estos sistemas tienen una alta sensibilidad, capaces de detectar p칠rdidas tan peque침as como 0.5 ml de sangre, incluso con un hematocrito del 25% y flujos de ba침o (Qd) de 500-800 ml/min.
                    </p>
                    <p style="color: #ffffff;">
                        <strong>Detecci칩n de sangre en el dializado:</strong> Provoca una alarma y detiene inmediatamente la bomba de sangre.
                    </p>
                    <p style="color: #ffffff;">
                        <strong>Indicadores de rotura de membrana:</strong> 
                        <ul style="color: #ffffff;">
                            <li>Presi칩n Transmembrana (PTM) superior a 500 mmHg.</li>
                            <li>Da침o f칤sico en la membrana del dializador.</li>
                        </ul>
                    </p>
                    <button class="btn btn-light m-2" onclick="mostrarMensajeDrenaje()">Drenaje</button>
                    <button class="btn btn-light m-2" onclick="mostrarMensajePTM()">Presi칩n Transmembrana (PTM)</button>
                    `,
                color: '#8533ff'
            }
        };

        window.cambiarContenido = function (etapa) {
            if (datos[etapa]) {
                // Cambiar la imagen
                document.getElementById('imagen-base').src = datos[etapa].imagen;

                // Cambiar el texto y color de la tarjeta
                const tarjeta = document.getElementById('tarjeta-info');
                tarjeta.innerHTML = `<p>${datos[etapa].texto}</p>`;
                tarjeta.style.backgroundColor = datos[etapa].color;
            }
        };
    };

    window.showImage = function () {
        const etapa = document.getElementById('etapaseleccionada').value;
        if (etapa.startsWith('etapa')) {
            cambiarContenido(etapa);
        }
    };

    window.mostrarMensaje1 = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
        <p>Agua que ha sido tratada y es apta para ser usada en aplicaciones de hemodi치lisis, 
        incluyendo preparaci칩n de l칤quido de di치lisis, reproceso de dializadores, preparaci칩n de concentrados 
        y preparaci칩n de l칤quido de sustituci칩n para terapias convectivas [HDF].</p>
    `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    window.mostrarMensaje2 = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
        <p>En la hemodi치lisis, el flujo del l칤quido dializante (o dializado) es un aspecto crucial para la eficacia 
        del tratamiento. El flujo t칤pico del l칤quido dializante suele estar en el rango de 500 a 800 ml/min. 
        Sin embargo, el flujo exacto puede variar dependiendo del tipo de m치quina de hemodi치lisis utilizada, 
        las necesidades individuales del paciente y las prescripciones del m칠dico.</p>
        <p>Un flujo de l칤quido dializante adecuado es esencial para asegurar una eficiente remoci칩n de toxinas y 
        un buen equilibrio de electrolitos en la sangre del paciente.</p>
    `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };
    // Funci칩n para mostrar el mensaje de KoA
    window.mostrarKoA = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
        <p>El KoA es un indicador de la eficacia del dializador, es decir su m치xima capacidad de extraer solutos. 
        Es una propiedad intr칤nseca del dializador y es suministrado por el fabricante. Se calcula en funci칩n del flujo 
        sangu칤neo (Qb), del flujo de di치lisis (Qd) y del aclaramiento (K).</p>
    `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    // Funci칩n para mostrar el mensaje del Gradiente de Concentraci칩n
    window.mostrarGradiente = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
        <p>Es la diferencia de concentraci칩n de un soluto entre el compartimiento sangu칤neo y el del dializado. Este gradiente 
        es 칩ptimo cuando el l칤quido de di치lisis circula s칩lo una vez (paso 칰nico), a contracorriente y paralelo al flujo de la sangre.</p>
    `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    // Funci칩n para mostrar el mensaje de Dialisancia I칩nica
    window.mostrarDialisancia = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
        <p>La dialisancia i칩nica se define como la transferencia de iones a trav칠s de la membrana del dializador en ambos 
        sentidos. Est치 basada en la medida de la conductividad en el l칤quido de di치lisis a la entrada y a la salida. La 
        conductividad a la entrada depende de la cantidad de iones disueltos en el l칤quido de di치lisis, mientras que la 
        conductividad a la salida depende del efecto que el intercambio de iones con el plasma ejerce sobre la conductividad 
        a la entrada del l칤quido de di치lisis.</p>
        <p>Asumiendo que la transferencia de iones es similar a la transferencia de urea, se puede concluir que la dialisancia 
        i칩nica y el aclaramiento de urea son similares. Muchos de los modernos monitores de HD incluyen la determinaci칩n 
        continua de este par치metro, que se muestra en pantalla.</p>
    `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    // Funci칩n para mostrar el mensaje de Ultrafiltraci칩n
    window.mostrarUltrafiltracion = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
        <p>Consiste en el paso simult치neo a trav칠s de la membrana de di치lisis del solvente (agua plasm치tica) acompa침ado 
        de los solutos que pueden atravesar los poros de la membrana, bajo el efecto de un gradiente de presi칩n hidrost치tica. 
        El ultrafiltrado es el l칤quido extra칤do de la sangre a trav칠s de la membrana de di치lisis por este mecanismo.</p>
        <p>Su funci칩n es eliminar durante la sesi칩n de di치lisis el l칤quido retenido durante el per칤odo entredi치lisis.</p>
    `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    // Funci칩n para mostrar el mensaje de Difusi칩n
    window.mostrarDifusion = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
        <p>Consiste en el transporte pasivo de solutos a trav칠s de la membrana del dializador y se produce por la diferencia 
        de concentraci칩n entre ambos compartimientos. La cantidad de un soluto que difunde a trav칠s de la membrana depende 
        de dos factores:</p>
        <ul>
            <li>Coeficiente de transferencia de masas del dializador (KoA)</li>
            <li>Gradiente de concentraci칩n</li>
        </ul>
    `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    
    window.mostrarMensajeConductividad = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>La conductividad del agua es un par치metro com칰nmente utilizado para medir la pureza del agua utilizada en la hemodi치lisis. 
            Este valor est치 relacionado con la capacidad del agua para conducir corriente el칠ctrica, lo cual aumenta conforme mayor es la concentraci칩n de part칤culas con carga en el l칤quido.</p>
            <p>Un valor m치s bajo de conductividad indica mayor pureza del agua, lo que es deseable para evitar la alteraci칩n de la composici칩n del l칤quido dializante.</p>
        `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    window.mostrarMensajeTemperatura = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>La temperatura del l칤quido dializante debe mantenerse dentro de un rango espec칤fico, entre 35춿C y 37춿C. 
            Temperaturas m치s altas de 37.5춿C pueden inducir la coagulaci칩n sangu칤nea, lo que afectar칤a negativamente el tratamiento.</p>
            <p>Por otro lado, temperaturas inferiores a 34춿C pueden causar hipotermia al paciente, lo cual es peligroso durante el proceso de di치lisis.</p>
        `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    window.mostrarMensajePresion = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>La presi칩n del sistema de hemodi치lisis se mide en bares y debe mantenerse dentro de un rango normal de entre 1.5 y 2.5 bares. 
            Si la presi칩n es demasiado alta, puede indicar una obstrucci칩n en el sistema, lo que podr칤a comprometer la seguridad del tratamiento.</p>
            <p>Por el contrario, una presi칩n baja podr칤a ser un indicativo de una fuga en el sistema o un mal funcionamiento del equipo.</p>
        `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };
    window.mostrarMensajeLiquidoDialisis = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>El l칤quido de di치lisis es un fluido acuoso que contiene electrolitos, buffer, y usualmente glucosa. 
            Este se utiliza para intercambiar solutos con la sangre durante la hemodi치lisis. A menudo se lo denomina dializado o soluci칩n de di치lisis.</p>
            <p>El l칤quido de di치lisis fresco es el que ingresa al dializador, mientras que el l칤quido de di치lisis usado es el que egresa de este.</p>
        `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    window.mostrarMensajeLiquidoDialisisUltra = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>El l칤quido de di치lisis ultrapuro es una forma altamente purificada de l칤quido de di치lisis que puede ser utilizado en lugar del l칤quido de di치lisis convencional.</p>
        `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    window.mostrarMensajeConcentradoAcido = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>El concentrado 치cido es una soluci칩n 치cida de sales concentradas que, cuando se diluye con agua purificada y con el concentrado de bicarbonato, produce el l칤quido dializante. 
            En t칠rminos generales, la mayor칤a de los pacientes pueden dializarse con concentraciones i칩nicas estandarizadas del concentrado 치cido, aunque se recomienda individualizar el tipo de concentrado seg칰n las necesidades del paciente.</p>
        `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    window.mostrarMensajeConcentradoBicarbonato = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>El concentrado de bicarbonato es una soluci칩n concentrada de bicarbonato s칩dico. Cuando se diluye con agua purificada y con el concentrado 치cido, se obtiene el l칤quido dializante.</p>
            <p>Algunos concentrados de bicarbonato tambi칠n contienen cloruro s칩dico. El bicarbonato en forma de polvo es actualmente el sistema recomendado para la fabricaci칩n del l칤quido de di치lisis. 
            El bicarbonato sobrante de una sesi칩n de di치lisis debe desecharse.</p>
        `;
        // Mostrar el modal
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };


    window.mostrarMensajeDrenaje = function () {
        const modalBody = document.getElementById('modal-body');
        modalBody.innerHTML = `
            <p>Despu칠s de salir del dializador, el l칤quido de di치lisis usado se dirige a un sistema de tratamiento o desecho espec칤fico, seg칰n las normativas locales y las pol칤ticas del centro de hemodi치lisis.</p>
            <p><strong>Opciones comunes:</strong></p>
            <ul>
                <li><strong>Desag칲e:</strong> Es la opci칩n m치s com칰n, eliminando el l칤quido a trav칠s del sistema de alcantarillado del hospital o cl칤nica.</li>
                <li><strong>Tratamiento:</strong> Algunos centros tratan el l칤quido antes de desecharlo, especialmente donde hay regulaciones ambientales estrictas.</li>
                <li><strong>Reutilizaci칩n:</strong> Aunque poco frecuente, en algunas circunstancias el l칤quido puede ser purificado y reutilizado.</li>
            </ul>
        `;
        var myModal = new bootstrap.Modal(document.getElementById('miModal'));
        myModal.show();
    };

    window.mostrarMensajePTM = function () {
    const modalBody = document.getElementById('modal-body');
    modalBody.innerHTML = `
        <p>La <strong>Presi칩n Transmembrana (PTM)</strong> es el gradiente te칩rico de presiones que se genera dentro del dializador entre los compartimentos de sangre (<em>Pb</em>) y de l칤quido de di치lisis (<em>Pd</em>).</p>
    `;
    var myModal = new bootstrap.Modal(document.getElementById('miModal'));
    myModal.show();
};

</script>


{% endblock %}